name: trigger for chatapp-repo and pull Docker Images

on:
  repository_dispatch:
    types: [success-event]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: trigger chatapp repo to build-and-push image
        uses: peter-evans/repository-dispatch@v3
        with:
         token: ${{ secrets.TOKEN_TO_TRIGGER }}
         repository: olawaleade/chatapp
         event-type: my-event
      
      - name: Pull Latest Docker Images
        if: ${{ github.event.client_payload.message == 'Build and push successful' }}
        run: |
          docker pull olawde/backend:${{ github.event.client_payload.timestamp }}
          docker pull olawde/frontend:${{ github.event.client_payload.timestamp }}
